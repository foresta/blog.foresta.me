+++
categories = ["mathematics"]
date = "2019-02-24"
title = "チェビシェフの不等式"
thumbnail = ""
tags = ["statistics"]

+++

## はじめに

今回は `チェビシェフの不等式` について簡単に説明します。


## チェビシェフの不等式とは

確率分布がわかっていない時に、確率の値の検討をつけるといったケース現実にはよくあります。
平均と分散から、確率の大まかな見当をつけたいという時にある程度役に立つのが、チェビシェフの不等式です。

確率変数 $X$ はどんなものであっても、その期待値 $\mu = E(X)$ の周りに集まり、期待値から離れると次第に少なくなっていきます。その少なくなる程度は分散 $\sigma^2 = V(X)$ によります。
このときに、標準偏差 $\sigma = D(X)$ と単位にとるときに、次の不等式が成立します。

$$
P(|X - \mu| \ge k\sigma) \le \frac{1}{k^2}\ \ \ (k \gt 0)
$$

上記の式を、`チェビシェフの不等式` と言います。

まず、左辺 $P(|X - \mu| \ge k\sigma)$ をみていきます。\
これは、確率変数 $X$ と期待値 $\mu$ の距離が、標準偏差の $k$ 倍以上になる確率のことを示しています。

(下記の図で表している、青 ( $x \le -k\sigma$ ) と紫 ( $x \ge k\sigma$ )の領域のことです)

{{< figure src="/images/posts/chebyshevs_inequality/graph-1.png" width="400" caption="This graph exported by https://www.desmos.com/">}}

この確率が、 $\frac{1}{k^2}$ 以下になることを示しています。

たとえば、$k = 2$ とすると、$X \le -2\sigma, X \ge 2\sigma$ になる確率は、 $\frac{1}{4}$ 以下になるということです。


#### 例題
例として、 $E(X) = 1$ , $V(X) = \frac{1}{3}$ であるときに、 $0\le X\le 2$ となる確率について考えてみます。

$\mu = 1$, $\sigma = \frac{1}{\sqrt{3}}$ となります。\
$P(0 \le X \le 2) = 1 - P(X \le 0 \ かつ\ 2 \le X)$ なので、今回は、$|X - \mu| \ge 1$ を考えれば良さそうです。(0以下 かつ 2以上になる確率で期待値が1なので)

チェビシェフの不等式
$$
P(|X - \mu| \ge k\sigma) \le \frac{1}{k^2}\ \ \ (k \gt 0)
$$
の左辺と比べると、
$$
1 = k\sigma
$$
$$
k = \frac{1}{\sigma} = \sqrt{3}
$$

これをチェビシェフの不等式の右辺 $\frac{1}{k^2}$ に代入すると、
$$
\frac{1}{k^2} = \sigma^2 = \frac{1}{3}
$$
となります。

これで $P(X \le 0 \ かつ\ 2 \le X)$ が求められました。\
書き直すと、
$$
P(X \le 0 \ かつ\ 2 \le X) \le \frac{1}{3}
$$
よって、
$$
P(0 \le X \le 2) = 1 - P(X \le 0 \ かつ\ 2 \le X) \ge 1 - \frac{1}{3}
$$
$$
P(0 \le X \le 2) \ge \frac{2}{3}
$$
となりました。

### チェビシェフの不等式の証明

ここまでで紹介してきた、チェビシェフの不等式の証明をしてみます。

$$
E(X) = \mu = \int^{\infty}\_{-\infty} x\ f(x)\ dx
$$
$$
V(X) = \sigma^2 = E(\ (X-\mu)^2\ )
$$

より

$$
\sigma^2 = \int^{\infty}\_{-\infty} (x-\mu)^2\ f(x)\ dx
$$

ここで、 $I = (x: |x-\mu| \ge k\sigma )$ の範囲を考えその範囲の積分

$$
\int^{}\_{I} (x-\mu)^2\ f(x)\ dx
$$

は $[-\infty, \infty]$ の範囲の積分より必ず小さいことがわかります。よって、

$$
\sigma^2 \ge \int^{}\_{I} (x-\mu)^2\ f(x)\ dx
$$

が成り立ちます。\
また、
$$
|x - \mu| \ge k\sigma
$$

なので、以下も同様に成り立ちます。

$$
(x - \mu)^2 \ge (k\sigma)^2
$$

これらを考えると、

$$
\sigma^2 \ge \int^{}\_{I} (k\sigma)^2\ f(x)\ dx
$$
$$
\ \ \ \  \ge (k\sigma)^2 \int^{}\_{I} f(x)\ dx
$$

さらに、
$$
P(|X-\mu|\ge k\sigma) = \int^{}\_{I} f(x)\ dx
$$

なので、

$$
\sigma^2 \ge (k\sigma)^2 \cdot P(|X - \mu| \ge k\sigma)
$$

$k > 0$ として両辺を $(k\sigma)^2$ で割ると、

$$
P(|X - \mu| \ge k\sigma)^2 \le \frac{1}{k^2},\ \  (k \gt 0)
$$

となり示されました。

## まとめ

今回はチェビシェフの不等式について、その紹介と証明をしてみました。
この不等式は、大数の法則などとも関連してくるのでしっかりと理解しておきたいですね。
